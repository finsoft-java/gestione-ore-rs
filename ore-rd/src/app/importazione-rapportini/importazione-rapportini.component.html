<h5 style="margin-bottom: 30px;text-align:center">Importazione Ore Dipendenti</h5>

<div style="border: 1px;border-style: dashed;padding: 30px;text-align: center;">

    <div>
        <table mat-table class="mat-elevation-z8">
    
            <ng-container matColumnDef="serieDoc">
                <th mat-header-cell *matHeaderCellDef>Serie Doc.</th>
            </ng-container>
    
            <ng-container matColumnDef="nrDoc">
                <th mat-header-cell *matHeaderCellDef>Nr. Doc.</th>
            </ng-container>
    
            <ng-container matColumnDef="data">
                <th mat-header-cell *matHeaderCellDef>Data Doc.</th>
            </ng-container>
    
            <ng-container matColumnDef="altri">
                <th mat-header-cell *matHeaderCellDef>...</th>
            </ng-container>
    
            <ng-container matColumnDef="idDipendente">
                <th mat-header-cell *matHeaderCellDef>Dipendente</th>
            </ng-container>
    
            <ng-container matColumnDef="rifAtv">
                <th mat-header-cell *matHeaderCellDef>Atv.</th>
            </ng-container>
    
            <ng-container matColumnDef="codCommessa">
                <th mat-header-cell *matHeaderCellDef>Commessa</th>
            </ng-container>
    
            <ng-container matColumnDef="sottoCommessa">
                <th mat-header-cell *matHeaderCellDef>Sottocommessa</th>
            </ng-container>
    
            <ng-container matColumnDef="more">
                <th mat-header-cell *matHeaderCellDef>...</th>
            </ng-container>
    
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        </table>
        <br>
    </div>

    <div class="card mt-3" style="margin-bottom: 30px;" *ngIf="nomiFile[0] != null">
        <div class="card-header">Nome File</div>
        <ul class="list-group list-group-flush" *ngFor="let file of nomiFile">
            <li class="list-group-item">
                {{ file }}
            </li>
        </ul>
    </div>

    <div class="mb-2" *ngIf="progressInfos" style="margin-bottom: 30px !important;">
        <span>{{ progressInfos.fileName }}</span>
        <div class="progress">
            <div class="progress-bar progress-bar-info progress-bar-striped" role="progressbar" attr.aria-valuenow="{{ progressInfos.value }}" aria-valuemin="0" aria-valuemax="100" [ngStyle]="{ width: progressInfos.value + '%' }">
                {{ progressInfos.value }}%
            </div>
        </div>
    </div>
    <div class="alert alert-success" role="alert" *ngIf="message_success">
        <button type="button" class="close" (click)="resetAlertSuccess()">
            <span aria-hidden="true">&times;</span>
        </button>
        <div [innerHtml]="message_success">
        </div>
    </div>
    <div class="alert alert-danger" role="alert" *ngIf="message_error">
        <button type="button" class="close" (click)="resetAlertDanger()">
            <span aria-hidden="true">&times;</span>
        </button>
        <div [innerHtml]="message_error">
        </div>
    </div>
    <!--
    <div class="row" *ngIf="nomiFile">
        <div class="col-12" *ngFor="let file of nomiFile">
            {{file}}
        </div>
    </div>
-->
    <div class="row">
        <div class="col-3"></div>
        <div class="col-3">
            <button mat-raised-button color="primary" [disabled]="loading"  (click)="fileInput.click()">
              <span>Seleziona uno o pi√π file...</span>
              <input #fileInput type="file" multiple (change)="selectFiles($event)" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" style="display:none;" />
            </button>
        </div>

        <div class="col-3">
            <button mat-raised-button color="warn" [disabled]="!selectedFiles||loading" (click)="uploadFiles()" style="margin-right:15px;">Carica</button>
            <button mat-raised-button color="primary" [disabled]="!selectedFiles||loading" (click)="reset()">Reset</button>
        </div>

    </div>
</div>